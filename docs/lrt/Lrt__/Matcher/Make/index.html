<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Make (lrt.Lrt__.Matcher.Make)</title><link rel="stylesheet" href="../../../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../../index.html">lrt</a> &#x00BB; <a href="../../index.html">Lrt__</a> &#x00BB; <a href="../index.html">Matcher</a> &#x00BB; Make</nav><h1>Module <code>Matcher.Make</code></h1><p>Instantiate a matcher with a result type.</p></header><h3 class="heading">Parameters</h3><dl><code><a href="argument-1-Return/index.html">Return</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dl><h3 class="heading">Signature</h3><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type </span>t</code></dt><dd><p>A matcher. Cases can be added using <a href="index.html#val-add"><code>add</code></a> and it can be applied using <a href="index.html#val-apply"><code>apply</code></a>.</p></dd></dl><dl><dt class="spec type" id="type-return"><a href="#type-return" class="anchor"></a><code><span class="keyword">type </span>'a return</code><code><span class="keyword"> = </span><span class="type-var">'a</span> <a href="argument-1-Return/index.html#type-t">Return.t</a></code></dt><dd><p>The return type of the matcher. Patterns are registered together with a value of this type. On a successful match the registered value is returned.</p></dd></dl><dl><dt class="spec value" id="val-empty"><a href="#val-empty" class="anchor"></a><code><span class="keyword">val </span>empty : modulo_props:bool <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p>The empty matcher without any registered pattern. The parameter <code>modulo_props</code> controls whether properties are ignored or interpreted as distinguishing features of runtime types.</p><h4 id="properties"><a href="#properties" class="anchor"></a>Properties</h4><p>The handling of properties during matching requires special attention.</p><p>When <code>modulo_props:false</code> (default), properties are distinguishing features of runtime types. Two types that only differ in their outermost properties (e.g. one without and one with) will not unify and thus not match. The same is true if the properties are the same but their order is different. We attempt to provide associativity in the sense of <a href="../../Ttype/index.html#val-consume_outer_props"><code>Ttype.consume_outer_props</code></a>. A property is uniquely identified by its key, values are ignored during matching.</p><p>When <code>modulo_props:true</code>, properties are ignored for unification. Nevertheless, properties are preserved within the substituted runtime types.</p><p>TODO:</p><ul><li>Think about moving the <code>modulo_props</code> argument to <a href="index.html#val-apply"><code>apply</code></a>.</li><li>Think about automatic property handling: first check for pattern with property, if not registered, strip first property and retry.</li></ul></dd></dl><section><header><h3 id="pattern-candidates"><a href="#pattern-candidates" class="anchor"></a>Pattern candidates</h3></header><dl><dt class="spec value" id="val-add"><a href="#val-add" class="anchor"></a><code><span class="keyword">val </span>add : t:<span class="type-var">'a</span> <a href="../../../Lrt/Ttype/index.html#type-t">Lrt.Ttype.t</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-return">return</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>add ~t return m</code> adds pattern <code>t</code> with right hand side <code>return</code> to the matcher <code>m</code>.</p></dd></dl><div class="spec module-type" id="module-type-C0"><a href="#module-type-C0" class="anchor"></a><code><span class="keyword">module type </span><a href="module-type-C0/index.html">C0</a> = <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><dl><dt class="spec value" id="val-add0"><a href="#val-add0" class="anchor"></a><code><span class="keyword">val </span>add0 : (<span class="keyword">module </span><a href="module-type-C0/index.html">C0</a>) <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p>Add a case to the matcher. Equivalent to <a href="index.html#val-add"><code>add</code></a>.</p></dd></dl><div class="spec module-type" id="module-type-C1"><a href="#module-type-C1" class="anchor"></a><code><span class="keyword">module type </span><a href="module-type-C1/index.html">C1</a> = <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><dl><dt class="spec value" id="val-add1"><a href="#val-add1" class="anchor"></a><code><span class="keyword">val </span>add1 : (<span class="keyword">module </span><a href="module-type-C1/index.html">C1</a>) <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p>Adds a case to a matcher. One free variable.</p></dd></dl><div class="spec module-type" id="module-type-C2"><a href="#module-type-C2" class="anchor"></a><code><span class="keyword">module type </span><a href="module-type-C2/index.html">C2</a> = <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><dl><dt class="spec value" id="val-add2"><a href="#val-add2" class="anchor"></a><code><span class="keyword">val </span>add2 : (<span class="keyword">module </span><a href="module-type-C2/index.html">C2</a>) <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p>Adds a case to a matcher. Two free variables.</p></dd></dl></section><section><header><h3 id="matching-results"><a href="#matching-results" class="anchor"></a>Matching results</h3></header><dl><dt class="spec module-type" id="module-type-M0"><a href="#module-type-M0" class="anchor"></a><code><span class="keyword">module type </span><a href="module-type-M0/index.html">M0</a> = <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>A matching result without substituted variables.</p></dd></dl><dl><dt class="spec module-type" id="module-type-M1"><a href="#module-type-M1" class="anchor"></a><code><span class="keyword">module type </span><a href="module-type-M1/index.html">M1</a> = <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>A matching result with one substituted variable.</p></dd></dl><dl><dt class="spec module-type" id="module-type-M2"><a href="#module-type-M2" class="anchor"></a><code><span class="keyword">module type </span><a href="module-type-M2/index.html">M2</a> = <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>A matching result with two substituted variables.</p></dd></dl><dl><dt class="spec type" id="type-matched"><a href="#type-matched" class="anchor"></a><code><span class="keyword">type </span>'a matched</code><code><span class="keyword"> = </span></code><table class="variant"><tr id="type-matched.M0" class="anchored"><td class="def constructor"><a href="#type-matched.M0" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">M0</span><span class="keyword"> of </span>(<span class="keyword">module </span><a href="module-type-M0/index.html">M0</a> <span class="keyword">with</span> <span class="keyword">type </span><a href="module-type-M0/index.html#type-matched">matched</a> <span class="keyword">=</span> <span class="type-var">'a</span>)</code></td></tr><tr id="type-matched.M1" class="anchored"><td class="def constructor"><a href="#type-matched.M1" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">M1</span><span class="keyword"> of </span>(<span class="keyword">module </span><a href="module-type-M1/index.html">M1</a> <span class="keyword">with</span> <span class="keyword">type </span><a href="module-type-M1/index.html#type-matched">matched</a> <span class="keyword">=</span> <span class="type-var">'a</span>)</code></td></tr><tr id="type-matched.M2" class="anchored"><td class="def constructor"><a href="#type-matched.M2" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">M2</span><span class="keyword"> of </span>(<span class="keyword">module </span><a href="module-type-M2/index.html">M2</a> <span class="keyword">with</span> <span class="keyword">type </span><a href="module-type-M2/index.html#type-matched">matched</a> <span class="keyword">=</span> <span class="type-var">'a</span>)</code></td></tr></table></dt></dl></section><section><header><h3 id="application"><a href="#application" class="anchor"></a>Application</h3></header><dl><dt class="spec value" id="val-apply"><a href="#val-apply" class="anchor"></a><code><span class="keyword">val </span>apply : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> t:<span class="type-var">'a</span> <a href="../../../Lrt/Ttype/index.html#type-t">Lrt.Ttype.t</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-matched">matched</a> option</code></dt><dd><p><code>apply matcher ~t</code> matches runtime type <code>t</code> against previously registered patterns in <code>matcher</code>.</p></dd></dl><dl><dt class="spec value" id="val-apply_exn"><a href="#val-apply_exn" class="anchor"></a><code><span class="keyword">val </span>apply_exn : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> t:<span class="type-var">'a</span> <a href="../../../Lrt/Ttype/index.html#type-t">Lrt.Ttype.t</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-matched">matched</a></code></dt><dd><p>See <a href="index.html#val-apply"><code>apply</code></a>. Raises <code>Not_found</code> if no matching pattern is available.</p></dd></dl></section></div></body></html>